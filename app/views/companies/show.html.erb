<h3><%= "#{@company.name} (#{@company.symbol})" %></h3>

<div id="companyPriceChart"></div>

<div>
  <% @connected_quote_arr.reverse.each do |group| %>
    <table class="table table-condensed">
      <tr>
        <th>日期</th>
        <th>涨幅</th>
        <th>开市价</th>
        <th>收市价</th>
        <th>高位</th>
        <th>低位</th>
        <th>交易量</th>
      </tr>

      <% group.reverse! %>

      <% group.each_with_index do |quote, index| %>
        <tr>
          <td><%= quote.date.to_date %></td>

          <% if index != group.length - 1 %>
            <td>
              <%= "#{ ((group[index].close - group[index+1].close) / group[index+1].close * 100).round(2) } %" %>
            </td>
          <% else %>
            <td> - </td>
          <% end %>

          <td><%= quote.open %></td>
          <td><%= quote.close %></td>
          <td><%= quote.high %></td>
          <td><%= quote.low %></td>
          <td><%= quote.volume %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
</div>

<% if @annual_income_statements.any? %>
  <table class="table table-condensed">
    <% AnnualIncomeStatement.columns[4..88].each_with_index do |column, index| %>
      <tr>
        <td><%= "#{column.name}" %></td>
        <% @annual_income_statements.each do |statement| %>
          <td><%= statement["#{column.name}"] %></td>
        <% end %>
      </tr>
    <% end %>
  </table>
<% end %>

<!-- <table class="table table-condensed">
  <tr>
    <th>Date</th>
    <th>%</th>
    <th>Open</th>
    <th>High</th>
    <th>Low</th>
    <th>Close</th>
    <th>Volume</th>
    <th>Adjusted Close</th>
  </tr>
  <% @company.daily_quotes.where("volume > 0").order(:date).reverse.each do |q| %>
    <tr>
      <td><%= q.date.to_date %></td>
      <td><%= ((q.close - q.open) / q.open * 100).round(2) %></td>
      <td><%= q.open %></td>
      <td><%= q.high %></td>
      <td><%= q.low %></td>
      <td><%= q.close %></td>
      <td><%= q.volume %></td>
      <td><%= q.adj_close %></td>
    </tr>
  <% end %>
</table> -->